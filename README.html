<?xml version="1.0" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>CyberSource::SOAP::Checkout - A Modern Perl interface to CyberSource's SOAP API.</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rev="made" href="mailto:amiri@akbuntu.nonet" />
</head>

<body style="background-color: white">


<!-- INDEX BEGIN -->
<div name="index">
<p><a name="__index__"></a></p>

<ul>

	<li><a href="#name">NAME</a></li>
	<li><a href="#synopsis">SYNOPSIS</a></li>
	<li><a href="#why">WHY?</a></li>
	<li><a href="#author">AUTHOR</a></li>
	<li><a href="#contributors">CONTRIBUTORS</a></li>
	<li><a href="#license">LICENSE</a></li>
	<li><a href="#see_also">SEE ALSO</a></li>
</ul>

<hr name="index" />
</div>
<!-- INDEX END -->

<p>
</p>
<h1><a name="name">NAME</a></h1>
<p>CyberSource::SOAP::Checkout - A Modern Perl interface to CyberSource's SOAP API.</p>
<p>
</p>
<hr />
<h1><a name="synopsis">SYNOPSIS</a></h1>
<p>This is for single transactions of variable quantity.</p>
<p>You can use this as a standalone module by sending it a payment information hashref. You will receive a C::S::Checkout::Response object containing either a success message or an error message. If successful, you will also receive a payment_info hashref, suitable for storing in your database.</p>
<p>You must map the keys in the hashref you send (which also sets the keys for the payment_info hashref you receive back). CyberSource uses camelCased and otherwise idiosyncratic identifiers here, so this mapping cannot be avoided.</p>
<p>You can use this in a Catalyst application by using Catalyst::Model::Adaptor and setting your configuration file somewhat like this:</p>
<pre>
    &lt;Model::Checkout&gt;
        class   CyberSource::SOAP::Checkout
        &lt;args&gt;
            id  your_cybersource_id
            key your cybersource_key
            #production  1
            &lt;column_map&gt;
                firstName               firstname
                lastName                lastname
                street1             address1
                city                    city
                state           state
                postalCode          zip
                country         country
                email           email
                ipAddress               ip
                unitPrice               amount
                quantity                quantity
                currency                currency
                accountNumber   cardnumber
                expirationMonth expiry.month
                expirationYear  expiry.year
            &lt;/column_map&gt;
        &lt;/args&gt;
    &lt;/Model::Checkout&gt;</pre>
<p>So that in your payment processing controller you would get validated data back from a shopping cart or other form and do something like this:</p>
<pre>

    # If your checkout form is valid, call C::S::Checkout's process method:</pre>
<pre>
    my $response = $c-&gt;model('Checkout')-&gt;process( $c-&gt;req-&gt;params );</pre>
<pre>

    # Check the response object, branch accordingly.</pre>
<pre>
    if ( $response-&gt;success ) {</pre>
<pre>
        # Store a payment in your database</pre>
<pre>
        my $payment = $c-&gt;model('Payment')-&gt;create($response-&gt;payment_info);</pre>
<pre>
        $c-&gt;flash( status_msg =&gt; $response-&gt;success-&gt;{message} );
        $c-&gt;res-&gt;redirect($c-&gt;uri_for('I_got_your_money'));
    }
    
    else {
        $c-&gt;stash( error_msg =&gt; $response-&gt;error-&gt;{message} );
        return;
    }</pre>
<p></p>
<p>
</p>
<hr />
<h1><a name="why">WHY?</a></h1>
<p>Folks often have a need for simple and quick, but &quot;enterprise-level&quot; payment-gateway integration. CyberSource's Simple Order API still requires that you compile a binary, and it won't compile on 64-bit processors (no, not OSes, but processors, i.e., what I imagine to be most development workstations by now). So you have to use the SOAP API, which is unwieldy, not least because it uses XML. May no one struggle with this again.  :)</p>
<p>
</p>
<hr />
<h1><a name="author">AUTHOR</a></h1>
<p>Amiri Barksdale &lt;<a href="mailto:amiri@metalabel.com">amiri@metalabel.com</a>&gt;</p>
<p>
</p>
<hr />
<h1><a name="contributors">CONTRIBUTORS</a></h1>
<p>Tomas Doran (t0m) &lt;<a href="mailto:bobtfish@bobtfish.net">bobtfish@bobtfish.net</a>&gt;</p>
<p>
</p>
<hr />
<h1><a name="license">LICENSE</a></h1>
<p>This library is free software; you can redistribute it and/or modify
it under the same terms as Perl itself.</p>
<p>
</p>
<hr />
<h1><a name="see_also">SEE ALSO</a></h1>
<p><a href="/Catalyst/Model/Adaptor.html">the Catalyst::Model::Adaptor manpage</a> <a href="/Business/OnlinePayment/CyberSource.html">the Business::OnlinePayment::CyberSource manpage</a></p>

</body>

</html>
